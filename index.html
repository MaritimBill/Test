<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>PEM Electrolyzer ‚Äî Web MPC & ANN</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- TensorFlow.js -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.7.0/dist/tf.min.js"></script>
  <!-- MQTT.js (browser build) -->
  <script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
  <!-- Chart.js for plots -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <header class="header">
    <h1>üè≠ PEM Electrolyzer ‚Äî Web MPC</h1>
    <div id="statusBar">
      <span id="mqttStatus">MQTT: ‚è≥</span>
      <span id="modelStatus">Models: ‚è≥</span>
      <span id="waterStatus">Water: -- L</span>
    </div>
  </header>

  <main class="container">
    <section class="controls card">
      <h2>Controls</h2>
      <div class="row">
        <label>Mode</label>
        <select id="modeSelect">
          <option value="auto">AUTO</option>
          <option value="manual">MANUAL</option>
          <option value="mpc">MPC</option>
          <option value="economic">HE-NMPC</option>
        </select>
      </div>

      <div class="row">
        <label>Manual Current (A)</label>
        <input id="manualCurrent" type="number" min="50" max="200" value="150" />
        <button id="applyManual">Apply</button>
      </div>

      <div class="row">
        <label>Request MPC decision</label>
        <button id="requestMPC">Compute MPC</button>
        <button id="refillWater">Refill Water (web)</button>
      </div>

      <h3>Recent MPC metrics</h3>
      <canvas id="mpcCostChart" height="120"></canvas>
    </section>

    <section class="status card">
      <h2>System Status</h2>
      <div class="statusGrid">
        <div>Applied Current: <b id="appliedCurrent">-- A</b></div>
        <div>Grid Ratio: <b id="gridRatio">-- %</b></div>
        <div>PV Ratio: <b id="pvRatio">-- %</b></div>
        <div>Water Tank: <b id="waterTank">-- L</b></div>
        <div>O‚ÇÇ Rate: <b id="o2Rate">-- L/h</b></div>
      </div>

      <h3>Water level (real time)</h3>
      <progress id="waterBar" value="0" max="100"></progress>

      <h3>Performance Metrics</h3>
      <canvas id="perfChart" height="160"></canvas>
    </section>

    <section class="log card">
      <h2>Event Log</h2>
      <textarea id="log" readonly></textarea>
    </section>
  </main>

  <!-- app scripts -->
  <script src="kenya-data.js"></script>
  <script src="henmpc-controller.js"></script>
  <script src="mpc-controller.js"></script>
  <script src="app.js"></script>
</body>
</html>
